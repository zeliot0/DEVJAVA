{% extends 'theme/base.html.twig' %}

{% block title %}Questions - {{ theme.nom }}{% endblock %}

{% block body %}
<div class="wrap">

  <section class="page-header">
    <div class="page-title">
      <a href="{{ path('app_theme_index') }}" class="btn ghost">
        Retour aux themes
      </a>

      <h1>
        Questions
        <span style="opacity:.5;font-weight:600">- {{ theme.nom }}</span>
      </h1>

      <div class="meta-row">
        <span class="badge {{ theme.actif ? 'active' : 'inactive' }}">
          {{ theme.actif ? 'Actif' : 'Inactif' }}
        </span>

        <span class="priority-chip">
          <i class="fa-solid fa-flag"></i>
          <em>P{{ theme.priorite ?? 2 }}</em>
          <small class="priority-stars" aria-label="Priorite {{ theme.priorite ?? 2 }} sur 5">
            {% for i in 1..5 %}
              <i class="fa-star {{ i <= (theme.priorite ?? 2) ? 'fa-solid' : 'fa-regular' }}"></i>
            {% endfor %}
          </small>
        </span>
      </div>

      {% if theme.descriptionQ %}
        <p class="description_q">{{ theme.descriptionQ }}</p>
      {% endif %}
    </div>

    <div class="actions">
      <a href="{{ path('app_question_new', { id: theme.idT }) }}" class="btn primary">
        Ajouter une question
      </a>

      <a href="{{ path('app_theme_answer', { id: theme.idT }) }}" class="btn secondary">
        Voir cote utilisateur
      </a>
    </div>
  </section>

  <section class="questions-grid">

    {% if questions is empty %}
      <div class="empty-state">
        <i class="fa-regular fa-circle-question"></i>
        <h3>Aucune question</h3>
        <p>Ce theme ne contient encore aucune question.</p>
      </div>
    {% else %}

      <div class="questions-grid">
        {% for question in questions %}
          <div class="question-card">

            <div class="question-header">
              <span class="status {{ question.actif ? 'active' : 'inactive' }}">
                {{ question.actif ? 'Active' : 'Inactive' }}
              </span>

              <div class="meta">
                <span>
                  <i class="fa-solid fa-tag"></i>
                  {{ question.type }}
                </span>

                <span>
                  <i class="fa-solid fa-clock"></i>
                  {{ question.frequence }}
                </span>
              </div>
            </div>

            <div class="question-body">
              <p>{{ question.texte }}</p>
            </div>

            <div class="question-footer">
              <div class="extra">
                {% if question.unite %}
                  <span>
                    <i class="fa-solid fa-ruler"></i>
                    {{ question.unite }}
                  </span>
                {% endif %}

                {% if question.valeurIdeale %}
                  <span>
                    {{ question.valeurIdeale }}
                  </span>
                {% endif %}
              </div>

              <div class="actions">
                <a href="{{ path('app_question_edit', { id: question.id }) }}" class="btn small">
                  Modifier
                </a>

                <form method="post"
                      action="{{ path('app_question_delete', { id: question.id }) }}"
                      onsubmit="return confirm('Supprimer cette question ?')">
                  <input type="hidden"
                         name="_token"
                         value="{{ csrf_token('delete' ~ question.id) }}">
                  <button class="btn danger small">
                    Supprimer
                  </button>
                </form>
              </div>
            </div>

          </div>
        {% endfor %}
      </div>

    {% endif %}
  </section>

</div>
{% endblock %}

