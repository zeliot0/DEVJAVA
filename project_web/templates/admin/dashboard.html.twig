{% extends 'admin/base.html.twig' %}

{% block admin_page_title %}Dashboard Général{% endblock %}
{% block admin_page_hint %}État de santé et statistiques globales de la plateforme NEXA{% endblock %}

{% block admin_content %}
    <div class="kpi-row">
        <div class="kpi-card" style="border-left: 5px solid var(--primary);">
            <div class="kpi-label">Utilisateurs</div>
            <div class="kpi-value">{{ totalUsers }}</div>
            <div class="kpi-sub">Comptes actifs sur NEXA</div>
        </div>

        <div class="kpi-card" style="border-left: 5px solid var(--accent);">
            <div class="kpi-label">Tâches</div>
            <div class="kpi-value">{{ totalTasks }}</div>
            <div class="kpi-sub">Volume global de travail</div>
        </div>

        <div class="kpi-card" style="border-left: 5px solid var(--good);">
            <div class="kpi-label">Actions</div>
            <div class="kpi-value">{{ totalExecutions }}</div>
            <div class="kpi-sub">Exécutions suivies</div>
        </div>

        <div class="kpi-card" style="border-left: 5px solid var(--warn);">
            <div class="kpi-label">Uptime</div>
            <div class="kpi-value">99.9%</div>
            <div class="kpi-sub">Système stable</div>
        </div>
    </div>

    <div class="adm-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div class="panel">
            <div class="panel-title" style="font-weight: 900; margin-bottom: 20px;"><i class="fa-solid fa-user-plus" style="color: var(--primary);"></i> Nouveaux Membres</div>
            <table class="adm-table" style="width: 100%;">
                <tbody>
                    {% for u in latestUsers %}
                        <tr>
                            <td style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; margin-bottom: 10px;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div class="badge" style="background: var(--gradient); width: 35px; height: 35px; border-radius: 10px; display: grid; place-items: center;"><i class="fa-solid fa-user"></i></div>
                                    <div style="font-weight: 800;">{{ u.email }}</div>
                                </div>
                            </td>
                        </tr>
                    {% else %}
                        <tr><td style="color: var(--muted);">Aucun utilisateur récent.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="panel">
            <div class="panel-title" style="font-weight: 900; margin-bottom: 20px;"><i class="fa-solid fa-bolt" style="color: var(--warn);"></i> Activité Récente</div>
            <table class="adm-table" style="width: 100%;">
                <tbody>
                    {% for t in latestTasks %}
                        <tr>
                            <td style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; margin-bottom: 10px;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div class="badge" style="background: rgba(159, 122, 234, 0.2); color: var(--accent); width: 35px; height: 35px; border-radius: 10px; display: grid; place-items: center;"><i class="fa-solid fa-file-invoice"></i></div>
                                    <div style="font-weight: 800;">{{ t.title }}</div>
                                </div>
                            </td>
                        </tr>
                    {% else %}
                        <tr><td style="color: var(--muted);">Aucune activité récente.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
